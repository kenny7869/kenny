<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VPC Basic | Kenny&#39;s Lab</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Lab memo">
    
    <link rel="preload" href="/kenny/assets/css/0.styles.94118319.css" as="style"><link rel="preload" href="/kenny/assets/js/app.60cdd7b5.js" as="script"><link rel="preload" href="/kenny/assets/js/2.54d9ad9d.js" as="script"><link rel="preload" href="/kenny/assets/js/4.9f0a2d0a.js" as="script"><link rel="prefetch" href="/kenny/assets/js/10.dc1f91cb.js"><link rel="prefetch" href="/kenny/assets/js/11.defe5c3b.js"><link rel="prefetch" href="/kenny/assets/js/12.1855736e.js"><link rel="prefetch" href="/kenny/assets/js/13.320c9408.js"><link rel="prefetch" href="/kenny/assets/js/14.9ce9182b.js"><link rel="prefetch" href="/kenny/assets/js/15.a5fc433b.js"><link rel="prefetch" href="/kenny/assets/js/16.3e78893b.js"><link rel="prefetch" href="/kenny/assets/js/17.392c6e87.js"><link rel="prefetch" href="/kenny/assets/js/18.56654712.js"><link rel="prefetch" href="/kenny/assets/js/19.af9fb77f.js"><link rel="prefetch" href="/kenny/assets/js/20.4fe9f6f1.js"><link rel="prefetch" href="/kenny/assets/js/21.935a564a.js"><link rel="prefetch" href="/kenny/assets/js/22.7c025e7e.js"><link rel="prefetch" href="/kenny/assets/js/23.edee2024.js"><link rel="prefetch" href="/kenny/assets/js/24.79b1e184.js"><link rel="prefetch" href="/kenny/assets/js/25.1be62e12.js"><link rel="prefetch" href="/kenny/assets/js/26.27b4b61c.js"><link rel="prefetch" href="/kenny/assets/js/27.23b1f6c8.js"><link rel="prefetch" href="/kenny/assets/js/3.1c0e6924.js"><link rel="prefetch" href="/kenny/assets/js/5.df946a28.js"><link rel="prefetch" href="/kenny/assets/js/6.3bf5eddd.js"><link rel="prefetch" href="/kenny/assets/js/7.ed69fcc3.js"><link rel="prefetch" href="/kenny/assets/js/8.91d9d4e6.js"><link rel="prefetch" href="/kenny/assets/js/9.d80bd4e3.js">
    <link rel="stylesheet" href="/kenny/assets/css/0.styles.94118319.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/kenny/" class="home-link router-link-active"><!----> <span class="site-name">Kenny's Lab</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/kenny/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/kenny/aws server/" class="nav-link">
  AWS Server
</a></div><div class="nav-item"><a href="/kenny/linuxserver/NetworkManager.html" class="nav-link">
  Linux Server
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AWS Certification" class="dropdown-title"><span class="title">AWS Certification</span> <span class="arrow down"></span></button> <button type="button" aria-label="AWS Certification" class="mobile-dropdown-title"><span class="title">AWS Certification</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kenny/aws certification/ACP/" class="nav-link">
  AWS Cloud Practitioner
</a></li><li class="dropdown-item"><!----> <a href="/kenny/aws certification/SAA/" class="nav-link">
  AWS Solutions Architect Associate
</a></li></ul></div></div><div class="nav-item"><a href="/kenny/Network Associate/VLAN.html" class="nav-link">
  Network Associate
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="English" class="dropdown-title"><span class="title">English</span> <span class="arrow down"></span></button> <button type="button" aria-label="English" class="mobile-dropdown-title"><span class="title">English</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kenny/english/hitutor/" class="nav-link">
  hitutor
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/phrase/" class="nav-link">
  phrase
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/nytimes.html" class="nav-link">
  NY Times
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/scmp/" class="nav-link">
  South Morning China Post
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/StraitsTimes.html" class="nav-link">
  Straits Times
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/kenny/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/kenny/aws server/" class="nav-link">
  AWS Server
</a></div><div class="nav-item"><a href="/kenny/linuxserver/NetworkManager.html" class="nav-link">
  Linux Server
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="AWS Certification" class="dropdown-title"><span class="title">AWS Certification</span> <span class="arrow down"></span></button> <button type="button" aria-label="AWS Certification" class="mobile-dropdown-title"><span class="title">AWS Certification</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kenny/aws certification/ACP/" class="nav-link">
  AWS Cloud Practitioner
</a></li><li class="dropdown-item"><!----> <a href="/kenny/aws certification/SAA/" class="nav-link">
  AWS Solutions Architect Associate
</a></li></ul></div></div><div class="nav-item"><a href="/kenny/Network Associate/VLAN.html" class="nav-link">
  Network Associate
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="English" class="dropdown-title"><span class="title">English</span> <span class="arrow down"></span></button> <button type="button" aria-label="English" class="mobile-dropdown-title"><span class="title">English</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kenny/english/hitutor/" class="nav-link">
  hitutor
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/phrase/" class="nav-link">
  phrase
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/nytimes.html" class="nav-link">
  NY Times
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/scmp/" class="nav-link">
  South Morning China Post
</a></li><li class="dropdown-item"><!----> <a href="/kenny/english/StraitsTimes.html" class="nav-link">
  Straits Times
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/kenny/aws%20server/" aria-current="page" class="sidebar-link">AWS 各項服務 For Server</a></li><li><a href="/kenny/aws server/awshttpd2tomcat.html" class="sidebar-link">AWS/HTTPD/TOMCAT</a></li><li><a href="/kenny/aws server/IAM.html" class="sidebar-link">Introduction to IAM</a></li><li><a href="/kenny/aws server/VPC.html" class="active sidebar-link">VPC Basic</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kenny/aws server/VPC.html#應用場景" class="sidebar-link">應用場景</a></li><li class="sidebar-sub-header"><a href="/kenny/aws server/VPC.html#核心名詞" class="sidebar-link">核心名詞</a></li><li class="sidebar-sub-header"><a href="/kenny/aws server/VPC.html#架構" class="sidebar-link">架構</a></li><li class="sidebar-sub-header"><a href="/kenny/aws server/VPC.html#vpc-四大類對接方式" class="sidebar-link">VPC 四大類對接方式</a></li><li class="sidebar-sub-header"><a href="/kenny/aws server/VPC.html#vpc-classic-lab" class="sidebar-link">VPC Classic LAB</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vpc-basic"><a href="#vpc-basic" class="header-anchor">#</a> VPC Basic</h1> <h2 id="應用場景"><a href="#應用場景" class="header-anchor">#</a> 應用場景</h2> <p>在傳統業務需求當中，會為資訊產品建立一個獨立網路環境規劃，因此就需要 VPC，VPC 與 VPC 之間會互相隔離，避免之間直接存取資料。VPC 可以在所有可用區域內建立，並新增一個或多個子網路。</p> <h2 id="核心名詞"><a href="#核心名詞" class="header-anchor">#</a> 核心名詞</h2> <ul><li><p>Internet Gateway (網際網路閘道)：是一種水平擴展、備援且高可用性的 VPC 元件，允許 VPC 與網際網路之間的通訊。Internet Gateway 有兩種用途：在 VPC 路由表中提供可由網際網路路由之流量的目標，以及針對已獲指派公有 IPv4 地址的執行個體執行網路位址轉譯 (NAT)。</p></li> <li><p>路由表 (Route table) ：一組名為路由的規則，用來判斷網路流量的方向</p> <ul><li>主路由表 (Main route table)：自動隨附於 VPC 的路由表。它會控制所有並未與任何其他路由表明確建立關聯之子網路的路由。</li> <li>自訂路由表 (Custom route table)：自己為 VPC 建立的路由表。</li> <li>路由表關聯 (Route table association)：路由表與子網路、網際網路閘道或虛擬私有閘道之間的關聯。</li> <li>子網路路由表 (Subnet route table)：與子網路相關聯的路由表。</li> <li>閘道路由表 (Gateway route table)：與網際網路閘道或虛擬私有閘道相關聯的路由表。</li> <li>本機閘道路由表 (Local gateway route table)：與 Outposts 本機閘道相關聯的路由表。</li> <li>目的地 (Destination)：想要流量傳送的 IP 位址範圍 (目的地 CIDR)。</li> <li>目標 (Target)：要透過其傳送目的地流量的閘道、網路介面或連線；例如，網際網路閘道。</li> <li>本機路由 (Local route)：VPC 內用於通訊的預設路由。</li></ul></li> <li><p>子網路 (Subnet)： 建立 VPC 之後，可以在各個可用區域 (Availability Zone) 新增一或多個子網路。在業界實務中，會按照產品需求切割網段，並將 Instance 分別擺在不同網段。一個 subnet 只能存在一個 Availability Zone。</p></li> <li><p>NAT Gateway (網路位址轉譯閘道)：讓私有子網路中的執行個體連線至網際網路或其他 AWS 服務，但防止網際網路啟動與這些執行個體的連線。若要建立 NAT 閘道，必須指定 NAT 閘道所在的公有子網路 (Pubilc Subnet)。</p></li> <li><p>VPC 端點 (VPC endpoint)：將 VPC 私下連線至支援的 AWS 服務以及具有 AWS PrivateLink 功能的 VPC 端點服務，而不需要網際網路閘道、NAT 裝置、VPN 連接或 AWS Direct Connect 連線</p></li> <li><p>Peering Connection：有些時候，資料對接時希望不要透過外部網路溝通，此時透過 Peering Connection 可以讓兩個 VPC 之間進行內部網路溝通</p> <ul><li><strong>注意</strong>：必須確保VPC內沒有重疊的 IPv4 CIDR， 否則 VPC 相互連線會形成 failed</li></ul></li> <li><p>VPN Connection：以私有 IP 的方式串連本地網路與雲端網路環境</p></li> <li><p>Flow Logs：可以擷取傳入及傳出 VPC 中網路介面之 IP 流量相關資訊，並可發布至  Amazon CloudWatch Logs 與 S3。</p></li></ul> <h2 id="架構"><a href="#架構" class="header-anchor">#</a> 架構</h2> <h4 id="生活場景"><a href="#生活場景" class="header-anchor">#</a> 生活場景</h4> <p><img src="/kenny/assets/img/VPC-1.ce44bbfa.jpg" alt="VPC-1" title="VPC-1"></p> <h4 id="經典雲端網路環境架構"><a href="#經典雲端網路環境架構" class="header-anchor">#</a> 經典雲端網路環境架構</h4> <p><img src="/kenny/assets/img/VPC-2.426c8937.jpg" alt="VPC-2" title="VPC-2"></p> <h2 id="vpc-四大類對接方式"><a href="#vpc-四大類對接方式" class="header-anchor">#</a> VPC 四大類對接方式</h2> <ol><li>私有網段連接外網：NAT Gateway</li></ol> <p><img src="/kenny/assets/img/VPC-3.88cbd5f2.jpg" alt="VPC-3" title="VPC-3"></p> <ol start="2"><li>VPC 以內網方式操作 AWS 服務：VPC Endpoint
<ul><li>AWS 的服務，預設情況下，與 VPC 內的 Instance 進行連線，會從外部網路進行存取，因此若要以內網方式進行連線，便以 VPC Endpoint 讓 VPC 內 Instance 可以內網的方式與 AWS 服務進行串接</li></ul></li></ol> <p><img src="/kenny/assets/img/VPC-4.8ca88907.jpg" alt="VPC-4" title="VPC-4"></p> <ol start="3"><li>VPC 串接 VPC：Peering Connection
<ul><li>當有多個獨立產品分別採用獨立的 VPC，當需要進行資料共享時，在預設情況下，兩個 VPC 必須透過外部網路相互連線，為了讓兩個 VPC 可以內網方式進行串接，可透過 Peering Connection 讓兩者之間以私有 IP 進行連線</li></ul></li></ol> <p><img src="/kenny/assets/img/VPC-5.6cc7c094.jpg" alt="VPC-5" title="VPC-5"></p> <ol start="4"><li>VPC 串接本地網路：VPN Connection
<ul><li>當公司本地端網路環境要與 VPC 進行串接，預設情況下，必須以外網進行串接，透過 VPN Connection 即可透過內網且加密的方式進行串接</li></ul></li></ol> <p><img src="/kenny/assets/img/VPC-6.28f027c5.jpg" alt="VPC-6" title="VPC-6"></p> <h2 id="vpc-classic-lab"><a href="#vpc-classic-lab" class="header-anchor">#</a> VPC Classic LAB</h2> <p><strong>創建VPC步驟</strong></p> <ol><li><p>通過 AWS 管理控制台找到 VPC<br> <img src="/kenny/assets/img/VPC-7.499cd70c.png" alt="VPC-7" title="VPC-7"></p></li> <li><p>從左側邊攔中單擊 <code>Your VPCs</code></p></li> <li><p>點擊 <code>Create VPC</code><br> <img src="/kenny/assets/img/VPC-8.53c3972d.png" alt="VPC-8" title="VPC-8"></p> <ul><li>Name tag：輸入一個 VPC 名稱以標識您的 VPC。例如：MyVPC</li> <li>IPv4 CIDR block：輸入 10.0.0.0/16</li> <li>Tenancy：不需要更改，確認 Default 已選擇</li> <li>然後點擊 <code>Create VPC</code><br> <img src="/kenny/assets/img/VPC-9.8fde324e.png" alt="VPC-9" title="VPC-9"></li></ul></li> <li><p>創建 VPC 後，將顯示詳細信息，如下所示<br> <img src="/kenny/assets/img/VPC-10.077c6303.png" alt="VPC-10" title="VPC-10"></p></li></ol> <p><strong>創建 Subnet 步驟</strong></p> <ol><li><p>創建 Public Subnet</p> <ul><li><p>單擊左側菜單中的 <code>Subnets</code><br> <img src="/kenny/assets/img/VPC-11.c53a3d57.png" alt="VPC-11" title="VPC-11"></p></li> <li><p>再點擊 <code>Create subnet</code><br> <img src="/kenny/assets/img/VPC-12.86bac448.png" alt="VPC-12" title="VPC-12"></p></li> <li><p>VPC：從先前創建的列表中選擇 MyVPC</p></li> <li><p>Availability Zone : 選擇 us-east-1a</p></li> <li><p>IPv4 CIDR block : 輸入 10.0.1.0/24<br> <img src="/kenny/assets/img/VPC-13.e328748b.png" alt="VPC-13" title="VPC-13"></p></li></ul></li> <li><p>創建 Private Subnet</p> <ul><li>VPC：從先前創建的列表中選擇 MyVPC</li> <li>Availability Zone : 選擇 us-east-1b</li> <li>IPv4 CIDR block : 輸入 10.0.2.0/24<br> <img src="/kenny/assets/img/VPC-14.06a9f18b.png" alt="VPC-14" title="VPC-14"></li></ul></li> <li><p>創建和配置 Internet Gateway</p> <ul><li><p>從左側邊攔中單擊 <code>Internet Gateway</code><br> <img src="/kenny/assets/img/VPC-15.cddadbc7.png" alt="VPC-15" title="VPC-15"></p></li> <li><p>創建 <code>Internet Gateway</code></p></li> <li><p>Name Tag : 輸入 MyInternetGateway<br> <img src="/kenny/assets/img/VPC-16.43831c56.png" alt="VPC-16" title="VPC-16"></p></li> <li><p>從列表中選擇您創建的 Internet Gateway</p></li> <li><p>點擊 <code>Actions</code></p></li> <li><p>再點擊 <code>Click on Attach to VPC</code><br> <img src="/kenny/assets/img/VPC-17.e8f1ccc9.png" alt="VPC-17" title="VPC-17"></p></li> <li><p>從列表中選擇創建的 MyVPC，然後點擊 <code>Attach internet gateway</code><br> <img src="/kenny/assets/img/VPC-18.bafe8c38.png" alt="VPC-18" title="VPC-18"></p></li></ul></li></ol> <p><strong>創建 Route Tables</strong></p> <ol><li><p>創建 PublicRouteTable</p> <ul><li><p>Name Tag：輸入 PublicRouteTable</p></li> <li><p>VPC：從清單中選擇 MyVPC<br> <img src="/kenny/assets/img/VPC-19.92df1e4a.png" alt="VPC-19" title="VPC-19"></p></li> <li><p>點選 PublicRouteTable 並選擇 <code>Subnet Associations</code></p></li> <li><p>點擊 <code>Edit subnet associations</code><br> <img src="/kenny/assets/img/VPC-20.456595a1.png" alt="VPC-20" title="VPC-20"></p></li> <li><p>從清單中選擇 <strong>MyPublicSubnet</strong> <br> <img src="/kenny/assets/img/VPC-21.cd1add59.png" alt="VPC-21" title="VPC-21"></p></li></ul></li> <li><p>創建 PrivateRouteTable</p> <ul><li>Name Tag：輸入 PrivateRouteTable</li> <li>VPC：從清單中選擇 MyVPC</li> <li>點選 PrivateRouteTable 並選擇 Subnet Associations</li> <li>點擊 <code>Edit subnet associations</code></li> <li>從清單中選擇 <strong>MyPrivateSubnet</strong></li></ul></li> <li><p>PublicRouteTable：添加路由以允許 Internet 流量到達 VPC</p> <ul><li>選取路由頁簽，單擊 <code>Edit Route</code></li> <li>點擊 <code>Add Route</code></li> <li>Destination：0.0.0.0/0</li> <li>Target：從下拉菜單中選擇 Internet Gateway 選擇 MyInternetGateway<br> <img src="/kenny/assets/img/VPC-22.a2a6f59c.png" alt="VPC-22" title="VPC-22"></li></ul></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/kenny/aws server/IAM.html" class="prev">
        Introduction to IAM
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/kenny/assets/js/app.60cdd7b5.js" defer></script><script src="/kenny/assets/js/2.54d9ad9d.js" defer></script><script src="/kenny/assets/js/4.9f0a2d0a.js" defer></script>
  </body>
</html>
