(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{376:function(a,s,e){"use strict";e.r(s);var t=e(42),r=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"firewalld"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#firewalld"}},[a._v("#")]),a._v(" Firewalld")]),a._v(" "),e("h2",{attrs:{id:"安裝-firewalld"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安裝-firewalld"}},[a._v("#")]),a._v(" 安裝 firewalld")]),a._v(" "),e("ul",[e("li",[a._v("請先確認 iptables 是否有被啟用，若系統上原本就有運行 iptables 的防火牆，一定要先將其關閉後，才能啟用 firewalld")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 檢查 iptables 服務是否正在運行")]),a._v("\nsystemctl status iptables\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止正在執行的 iptables 服務")]),a._v("\nsystemctl stop iptables\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 將 iptables 服務永久關閉")]),a._v("\nsystemctl mask iptables\n")])])]),e("ul",[e("li",[a._v("firewalld 在 RHEL/CentOS 7、8，應該是預設就會安裝好的，若您的系統上沒有安裝，可用 yum 安裝")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 檢查 firewalld 服務狀態")]),a._v("\nsystemctl status firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 啟動 firewalld 服務")]),a._v("\nsystemctl start firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 停止 firewalld 服務")]),a._v("\nsystemctl stop firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重新啟動 firewalld 服務")]),a._v("\nsystemctl restart firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#重新載入防火牆設定")]),a._v("\nfirewall-cmd --reload\n")])])]),e("h2",{attrs:{id:"查詢"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查詢"}},[a._v("#")]),a._v(" 查詢")]),a._v(" "),e("ul",[e("li",[a._v("查詢預設區域")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --get-default-zone\n")])])]),e("ul",[e("li",[a._v("查看 "),e("code",[a._v("firewalld")]),a._v(" 有支援的服務")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --get-services\n")])])]),e("ul",[e("li",[a._v("查看目前區域中有開 Port 的服務")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --list-services\n")])])]),e("ul",[e("li",[a._v("列出詳細設定")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd  --list-all\n")])])]),e("h2",{attrs:{id:"開啟連接埠"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#開啟連接埠"}},[a._v("#")]),a._v(" 開啟連接埠")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("-zone")]),a._v("：指定區域")]),a._v(" "),e("li",[e("code",[a._v("-add-port")]),a._v("：加入欲開啟的連接埠，並指定通訊協定")]),a._v(" "),e("li",[e("code",[a._v("–remove-port")]),a._v("：移除開啟的連接埠，並指定通訊協定")]),a._v(" "),e("li",[e("code",[a._v("–permanent")]),a._v("：重開系統就會永久生效")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("6666")]),a._v("/tcp --permanent\n\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --remove-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("6666")]),a._v("/tcp --permanent\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#一次開啟多個")]),a._v("\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("6666")]),a._v("-6670/tcp\n")])])]),e("ul",[e("li",[e("code",[a._v("–add-service")]),a._v("：透過服務名稱開放")]),a._v(" "),e("li",[e("code",[a._v("-remove-service")]),a._v("：透過服務名稱移除")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --permanent\n\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --remove-service"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql --permanent\n")])])]),e("h2",{attrs:{id:"連接埠轉發"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#連接埠轉發"}},[a._v("#")]),a._v(" 連接埠轉發")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("–add-forward-port")]),a._v("：將來自連接埠 A 的資料轉發")]),a._v(" "),e("li",[e("code",[a._v("toport")]),a._v("：轉發至本機其他指定 port")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-forward-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":proto"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tcp:toport"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2233")]),a._v("\n")])])]),e("ul",[e("li",[e("code",[a._v("toaddr")]),a._v("：資訊轉發到其他位址的相同連接埠")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-forward-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":proto"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tcp:toaddr"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".10.1\n")])])]),e("ul",[e("li",[e("code",[a._v("-add-masquerade")]),a._v("：連接埠轉發如果是不同主機，就要啟用區域的偽裝功能，將私有網路的地址將隱藏並映射到一個公有 IP")]),a._v(" "),e("li",[e("code",[a._v("–remove-masquerade")]),a._v("：移除偽裝功能")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-masquerade\n")])])]),e("h2",{attrs:{id:"rich-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rich-rules"}},[a._v("#")]),a._v(" Rich rules")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("–add-rich-rule")]),a._v("：新增")]),a._v(" "),e("li",[e("code",[a._v("–remove-rich-rule")]),a._v("：移除")]),a._v(" "),e("li",[a._v("IP白名單：允IP存取")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-rich-rule "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'rule family=\"ipv4\" source address=192.168.10.10 accept'")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#執行結果")]),a._v("\nrule "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("family")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ipv4"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("address")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.10.1"')]),a._v(" accept\n")])])]),e("ul",[e("li",[a._v("IP黑名單：拒絕IP存取")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-rich-rule "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('\'rule family="ipv4" source address="192.168.10.10" port port=22 protocol=tcp reject\'')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#執行結果")]),a._v("\nrule "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("family")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ipv4"')]),a._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("address")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.10.10"')]),a._v(" reject\n")])])]),e("ul",[e("li",[a._v("也可以利用rich rules來設定連接埠轉發，如果轉發至不同主機的話，masquerade要開啟")])]),a._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[a._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("public --add-rich-rule "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'rule family=ipv4 source address=192.168.10.1 forward-port port=80 protocol=tcp to-port=8080'")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);